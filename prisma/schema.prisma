// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

model User {
  id         String   @id @default(uuid())
  name       String
  email      String   @unique
  password   String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  pets Pet[]

  @@map("users")
}

model Pet {
  id     String  @id @default(uuid())
  userId String
  name   String
  age    Int
  breed  String
  sex    Boolean

  user   User?   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  Collar Collar?

  @@map("pets")
}

model Collar {
  id    String @id @default(uuid())
  token String
  petId String @unique

  pet          Pet            @relation(fields: [petId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  stress       Stress[]
  gps          GPS[]
  sound        Sound[]
  acelerometer Acelerometer[]
  hearRate     HeartRate[]

  @@map("collars")
}

model Stress {
  id             String @id @default(uuid())
  collarId       String
  soundId        String @unique
  acelerometerId String @unique
  heartRateId    String @unique
  totalValue     String

  sound        Sound?        @relation(fields: [soundId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  acelerometer Acelerometer? @relation(fields: [acelerometerId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  heartRate    HeartRate?    @relation(fields: [heartRateId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  Collar       Collar?       @relation(fields: [collarId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("stresses")
}

model GPS {
  id        String @id @default(uuid())
  collarId  String
  latitude  String
  longitude String

  Collar Collar? @relation(fields: [collarId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("gps")
}

model Sound {
  id       String @id @default(uuid())
  collarId String
  value    Int

  stress Stress?
  Collar Collar? @relation(fields: [collarId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("sounds")
}

model Acelerometer {
  id       String @id @default(uuid())
  collarId String
  x        String
  y        String
  z        String

  stress Stress?
  Collar Collar? @relation(fields: [collarId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("acelerometers")
}

model HeartRate {
  id       String @id @default(uuid())
  collarId String
  value    Int

  stress Stress?
  Collar Collar? @relation(fields: [collarId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@map("heart-rates")
}
